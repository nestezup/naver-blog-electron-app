<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naver Blog</title>
    <!-- Tailwind CSS v4 + DaisyUI (local) -->
    <link href="./css/style.css" rel="stylesheet" type="text/css" />
    <style>
        body { overflow: hidden; margin: 0; padding: 0; }
        webview { width: 100%; height: 100%; border: none; }
        .webview-container { position: relative; overflow: hidden; flex: 1; min-height: 0; }
        #loadingOverlay { position: absolute; inset: 0; background: white; z-index: 10; }
        #loadingOverlay.hidden { display: none; }
        .loading-spinner {
            width: 2rem; height: 2rem;
            border: 2px solid #e5e7eb; border-top: 2px solid #3b82f6;
            border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* 높이 문제 해결 - 명확한 레이아웃 */
        body .main-container {
            height: calc(100vh - 4rem);
            display: flex;
        }
        body .sidebar {
            width: 320px;
            flex-shrink: 0;
            display: block;
            position: relative;
            transform: none;
        }
        body .webview-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }
        .webview-section {
            flex: 1;
            position: relative;
            min-height: 0;
        }
        webview {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body class="h-screen flex flex-col bg-base-100">
    <!-- Header -->
    <div class="navbar bg-primary text-primary-content">
        <div class="navbar-start">
            <button id="toggleSidebar" class="btn btn-square btn-ghost">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5 stroke-current">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
        <div class="navbar-center">
            <span class="text-xl font-bold">Naver Blog</span>
        </div>
        <div class="navbar-end">
            <button id="toggleTheme" class="btn btn-square btn-ghost">
                <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5 stroke-current">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar bg-base-200">
            <div class="p-4 border-b">
                <h2 class="text-lg font-semibold">블로그 관리</h2>
            </div>
            <div class="p-4 border-b">
                <div class="flex items-center gap-3 mb-2">
                    <div id="loginStatus" class="w-3 h-3 rounded-full bg-error"></div>
                    <span id="loginText" class="text-sm">로그인되지 않음</span>
                </div>
                <button id="refreshCookies" class="btn btn-xs btn-outline">쿠키 새로고침</button>
            </div>
            <div class="p-4 border-b">
                <h3 class="text-sm font-semibold mb-2">내 블로그 설정</h3>
                <div class="space-y-2">
                    <input
                        id="blogIdInput"
                        type="text"
                        placeholder="블로그 ID (예: nest4000)"
                        class="input input-sm w-full"
                        value="">
                    <div class="flex gap-1">
                        <button id="saveBlogId" class="btn btn-xs btn-primary flex-1">저장</button>
                        <button id="goToMyBlog" class="btn btn-xs btn-outline flex-1">내 블로그</button>
                    </div>
                </div>
            </div>
            <div class="p-4 border-b">
                <h3 class="text-sm font-semibold mb-2">글 작성</h3>
                <div class="space-y-2">
                    <textarea
                        id="markdownInput"
                        placeholder="마크다운 내용을 입력하세요..."
                        class="textarea textarea-sm w-full h-32 resize-none"
                        rows="6"></textarea>
                    <div class="flex gap-1">
                        <button id="previewMarkdown" class="btn btn-xs btn-outline flex-1">미리보기</button>
                        <button id="createPostFromMarkdown" class="btn btn-xs btn-primary flex-1">마크다운으로 작성</button>
                    </div>
                </div>
            </div>
            <div class="p-4 border-b">
                <h3 class="text-sm font-semibold mb-2">샘플 테스트</h3>
                <div class="space-y-2">
                    <button id="createSamplePost" class="btn btn-xs btn-success w-full">샘플 글 작성</button>
                    <button id="createSamplePostWithMarkdown" class="btn btn-xs btn-info w-full">마크다운 샘플 작성</button>
                </div>
            </div>
            <div class="p-4">
                <ul class="menu">
                    <li><a id="createPost" href="#" class="cursor-pointer">테스트 글 작성</a></li>
                    <li><a>글 목록</a></li>
                    <li><a>설정</a></li>
                </ul>
            </div>
        </div>

        <!-- WebView Container -->
        <div class="webview-container">
            <!-- Navigation -->
            <div class="bg-base-200 px-4 py-2 flex items-center gap-2 border-b">
                <button id="goBack" class="btn btn-sm btn-ghost">←</button>
                <button id="goForward" class="btn btn-sm btn-ghost">→</button>
                <button id="refresh" class="btn btn-sm btn-ghost">↻</button>
                <div class="flex-1 mx-4">
                    <input id="urlInput" type="text" class="input input-sm w-full" value="https://blog.naver.com" readonly>
                </div>
            </div>

            <!-- WebView -->
            <div class="webview-section">
                <div id="loadingOverlay" class="flex items-center justify-center">
                    <div class="text-center">
                        <div class="loading-spinner mb-4"></div>
                        <p>네이버 블로그 로딩 중...</p>
                    </div>
                </div>
                <webview
                    id="blogWebview"
                    src="https://blog.naver.com"
                    nodeintegration="false"
                    webSecurity="true"
                    partition="persist:naver-blog">
                </webview>
            </div>
        </div>
    </div>

    <script src="./js/app.js"></script>
</body>
</html>